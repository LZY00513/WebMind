# ğŸ¯ WebMind æ ¸å¿ƒæŠ€æœ¯è¦ç‚¹å›¾è§£

> ç”¨å›¾è¡¨å’Œç®€æ´çš„è¯­è¨€ç†è§£é¡¹ç›®çš„æ ¸å¿ƒæŠ€æœ¯

---

## 1. æ•´ä½“æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç”¨æˆ·æ“ä½œ                           â”‚
â”‚              åœ¨ç½‘é¡µä¸Šé€‰ä¸­ä¸€æ®µæ–‡å­—                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Content Script (content.ts)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. ç›‘å¬ mouseup äº‹ä»¶                              â”‚   â”‚
â”‚  â”‚ 2. è·å–é€‰ä¸­æ–‡æœ¬ window.getSelection()            â”‚   â”‚
â”‚  â”‚ 3. æ˜¾ç¤ºæµ®åŠ¨æŒ‰é’®                                   â”‚   â”‚
â”‚  â”‚ 4. ç”¨æˆ·ç‚¹å‡» â†’ å‘é€æ¶ˆæ¯                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ chrome.runtime.sendMessage
                     â”‚ { type: 'COLLECT_TEXT', payload: {...} }
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Background Service Worker (service-worker.ts)   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. æ¥æ”¶æ¶ˆæ¯ï¼ˆæ¶ˆæ¯è·¯ç”±ä¸­å¿ƒï¼‰                       â”‚   â”‚
â”‚  â”‚ 2. åˆ›å»ºç¬”è®°å¯¹è±¡                                   â”‚   â”‚
â”‚  â”‚ 3. è°ƒç”¨ Offscreen Document                       â”‚   â”‚
â”‚  â”‚ 4. ä¿å­˜ç¬”è®°åˆ° Storage                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                    â”‚
      â”‚ åˆ›å»º/é€šä¿¡                          â”‚ ä¿å­˜
      â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Offscreen Document      â”‚    â”‚   Chrome Storage API     â”‚
â”‚  (offscreen.ts)          â”‚    â”‚  (chrome.storage.local)  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ è°ƒç”¨ AI APIï¼š      â”‚   â”‚    â”‚ â”‚ webmind_notes: [  â”‚   â”‚
â”‚ â”‚ window.ai          â”‚   â”‚    â”‚ â”‚   { id, content,  â”‚   â”‚
â”‚ â”‚   .summarizer      â”‚   â”‚    â”‚ â”‚     summary, ... }â”‚   â”‚
â”‚ â”‚   .create()        â”‚   â”‚    â”‚ â”‚ ]                 â”‚   â”‚
â”‚ â”‚   .summarize()     â”‚   â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ è¿”å›æ‘˜è¦
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç”¨æˆ·ç•Œé¢ï¼ˆæŸ¥çœ‹ç¬”è®°ï¼‰                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Popup      â”‚           â”‚    Side Panel        â”‚    â”‚
â”‚  â”‚ æœ€è¿‘3æ¡ç¬”è®°   â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚  ç¬”è®°åˆ—è¡¨è§†å›¾   â”‚  â”‚    â”‚
â”‚                             â”‚  â”‚  (ç½‘æ ¼å¸ƒå±€)     â”‚  â”‚    â”‚
â”‚                             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚                             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚                             â”‚  â”‚  æ€ç»´å¯¼å›¾è§†å›¾   â”‚  â”‚    â”‚
â”‚                             â”‚  â”‚  (D3.js)       â”‚  â”‚    â”‚
â”‚                             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Offscreen Document æ¶æ„ï¼ˆæ ¸å¿ƒéš¾ç‚¹ï¼‰

### é—®é¢˜ï¼šä¸ºä»€ä¹ˆéœ€è¦ Offscreen Documentï¼Ÿ

```
Manifest V3 è§„èŒƒ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service Worker (service-worker.ts)     â”‚
â”‚  âŒ æ²¡æœ‰ DOM ç¯å¢ƒ                        â”‚
â”‚  âŒ æ²¡æœ‰ window å¯¹è±¡                     â”‚
â”‚  âŒ ä¸èƒ½è°ƒç”¨ window.ai                   â”‚
â”‚  âœ… å¯ä»¥å¤„ç†æ¶ˆæ¯                         â”‚
â”‚  âœ… å¯ä»¥è®¿é—® Chrome API                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Chrome Built-in AI è¦æ±‚:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… éœ€è¦ DOM ç¯å¢ƒ                        â”‚
â”‚  âœ… éœ€è¦ window å¯¹è±¡                     â”‚
â”‚  âœ… éœ€è¦ç”¨æˆ·æ¿€æ´»ï¼ˆuser activationï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

çŸ›ç›¾ï¼ğŸ¤”
```

### è§£å†³æ–¹æ¡ˆï¼šOffscreen Document

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Background Service Worker                           â”‚
â”‚                                                      â”‚
â”‚  async function callAI(text) {                       â”‚
â”‚    // 1. æ£€æŸ¥æ˜¯å¦å·²æœ‰ Offscreen Document            â”‚
â”‚    const contexts = await chrome.runtime             â”‚
â”‚      .getContexts({ contextTypes: ['OFFSCREEN'] });  â”‚
â”‚                                                      â”‚
â”‚    // 2. å¦‚æœæ²¡æœ‰ï¼Œåˆ›å»ºä¸€ä¸ª                          â”‚
â”‚    if (contexts.length === 0) {                      â”‚
â”‚      await chrome.offscreen.createDocument({         â”‚
â”‚        url: 'background/offscreen.html',             â”‚
â”‚        reasons: ['DOM_SCRAPING'],                    â”‚
â”‚        justification: 'ä½¿ç”¨ Chrome AI'               â”‚
â”‚      });                                             â”‚
â”‚    }                                                 â”‚
â”‚                                                      â”‚
â”‚    // 3. å‘é€æ¶ˆæ¯åˆ° Offscreen                        â”‚
â”‚    const response = await chrome.runtime             â”‚
â”‚      .sendMessage({                                  â”‚
â”‚        type: 'AI_SUMMARIZE',                         â”‚
â”‚        payload: { text }                             â”‚
â”‚      });                                             â”‚
â”‚                                                      â”‚
â”‚    return response.summary;                          â”‚
â”‚  }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ æ¶ˆæ¯ä¼ é€’
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Offscreen Document (offscreen.html + offscreen.ts)  â”‚
â”‚  âœ… æœ‰ DOM ç¯å¢ƒ                                       â”‚
â”‚  âœ… ä¸å¯è§ï¼ˆç”¨æˆ·çœ‹ä¸åˆ°ï¼‰                              â”‚
â”‚  âœ… å¯ä»¥è°ƒç”¨ window.ai                                â”‚
â”‚                                                      â”‚
â”‚  chrome.runtime.onMessage.addListener(async (msg) => {
â”‚    if (msg.type === 'AI_SUMMARIZE') {               â”‚
â”‚      // è°ƒç”¨ AI API                                  â”‚
â”‚      const summarizer = await window.ai              â”‚
â”‚        .summarizer.create({                          â”‚
â”‚          type: 'tldr',                               â”‚
â”‚          format: 'plain-text',                       â”‚
â”‚          length: 'medium'                            â”‚
â”‚        });                                           â”‚
â”‚                                                      â”‚
â”‚      const summary = await summarizer                â”‚
â”‚        .summarize(msg.payload.text);                 â”‚
â”‚                                                      â”‚
â”‚      summarizer.destroy(); // é‡Šæ”¾èµ„æº               â”‚
â”‚                                                      â”‚
â”‚      return { summary };                             â”‚
â”‚    }                                                 â”‚
â”‚  });                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢è¯•è¦ç‚¹

**é—®é¢˜**ï¼šChrome Built-in AI éœ€è¦ DOMï¼Œä½† Service Worker æ²¡æœ‰ DOM

**æ–¹æ¡ˆ**ï¼šåˆ›å»ºä¸å¯è§çš„ Offscreen Document ä½œä¸ºä»£ç†

**ä¼˜åŒ–**ï¼š
1. å¤ç”¨ Offscreen Documentï¼ˆä¸é‡å¤åˆ›å»ºï¼‰
2. ç”¨å®ŒåŠæ—¶é”€æ¯ï¼ˆé‡Šæ”¾å†…å­˜ï¼‰
3. é™çº§æ–¹æ¡ˆï¼ˆAI ä¸å¯ç”¨æ—¶ç”¨ç®€å•ç®—æ³•ï¼‰

---

## 3. D3.js åŠ›å¯¼å‘å›¾åŸç†ï¼ˆéš¾ç‚¹ï¼‰

### å››ç§åŠ›çš„ä½œç”¨

```
1. Link Force (å¼¹ç°§åŠ›) - æŠŠæœ‰è¿çº¿çš„èŠ‚ç‚¹æ‹‰åˆ°ä¸€èµ·
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  [èŠ‚ç‚¹A]  â†â”€â”€â”€â”€â”€å¼¹ç°§â”€â”€â”€â”€â”€â†’  [èŠ‚ç‚¹B]
                â†‘
                â”‚
          ç†æƒ³è·ç¦» 150px
          
  - è·ç¦»å¤ªè¿œ â†’ æ‹‰è¿‘
  - è·ç¦»å¤ªè¿‘ â†’ æ¨å¼€


2. Charge Force (ç”µè·åŠ›) - æ‰€æœ‰èŠ‚ç‚¹äº’ç›¸æ’æ–¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

        [èŠ‚ç‚¹A]
          â†“  â†˜  â†“  â†™  â†“   æ’æ–¥åŠ›
        [èŠ‚ç‚¹B] [èŠ‚ç‚¹C] [èŠ‚ç‚¹D]
          
  strength = -500 (è´Ÿæ•°è¡¨ç¤ºæ’æ–¥)
  å°±åƒåŒæ€§ç”µè·ï¼Œäº’ç›¸æ¨å¼€


3. Center Force (ä¸­å¿ƒåŠ›) - æŠŠæ•´ä¸ªå›¾æ‹‰å‘ä¸­å¿ƒ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          â”‚
  â”‚      [A]    [B]          â”‚
  â”‚        â†˜  â†™              â”‚
  â”‚         â—  â† ä¸­å¿ƒ         â”‚
  â”‚        â†—  â†–              â”‚
  â”‚      [C]    [D]          â”‚
  â”‚                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  é˜²æ­¢èŠ‚ç‚¹é£å‡ºè§†é‡


4. Collision Force (ç¢°æ’åŠ›) - é˜²æ­¢èŠ‚ç‚¹é‡å 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

      â•­â”€â”€â”€â”€â”€â”€â”€â•®
      â”‚ èŠ‚ç‚¹A â”‚  â† å®‰å…¨åŒºåŸŸ 60px
      â•°â”€â”€â”€â”€â”€â”€â”€â•¯
         â†•
     æœ€å°é—´è·
         â†•
      â•­â”€â”€â”€â”€â”€â”€â”€â•®
      â”‚ èŠ‚ç‚¹B â”‚
      â•°â”€â”€â”€â”€â”€â”€â”€â•¯
```

### ç‰©ç†æ¨¡æ‹Ÿè¿‡ç¨‹

```
åˆå§‹çŠ¶æ€ï¼ˆèŠ‚ç‚¹éšæœºåˆ†å¸ƒï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [A]                     â”‚
â”‚        [B]          [C]  â”‚
â”‚                          â”‚
â”‚   [D]        [E]         â”‚
â”‚                    [F]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ 1 å¸§ï¼ˆå¼€å§‹è¿åŠ¨ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [A]â†’                    â”‚
â”‚      â†™[B]â†        [C]â†“   â”‚
â”‚                 â—        â”‚
â”‚   [D]â†—      â†—[E]         â”‚
â”‚                  â†‘[F]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ 10 å¸§ï¼ˆè¿åŠ¨ä¸­ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     [A]                  â”‚
â”‚   â†™  â†“  â†˜                â”‚
â”‚ [D]  â—  [B]              â”‚
â”‚   â†–  â†‘  â†—                â”‚
â”‚    [E] [C]         [F]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ 100 å¸§ï¼ˆæ¥è¿‘å¹³è¡¡ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         [A]              â”‚
â”‚        â•±â”‚â•²               â”‚
â”‚      [D]â”‚[B]             â”‚
â”‚         â”‚                â”‚
â”‚        [E]â”€[C]â”€[F]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ 300 å¸§ï¼ˆè¾¾åˆ°å¹³è¡¡ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         [A]              â”‚
â”‚        â•±â”‚â•²               â”‚
â”‚      [D] â— [B]           â”‚
â”‚         â”‚ â•²              â”‚
â”‚        [E]â”€[C]â”€[F]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘
     æœ€ç»ˆå¸ƒå±€
```

### ä»£ç å®ç°

```typescript
// 1. å‡†å¤‡æ•°æ®
const nodes = [
  { id: 'A', label: 'React' },
  { id: 'B', label: 'TypeScript' },
  { id: 'C', label: 'Vite' },
  // ...
];

const links = [
  { source: 'A', target: 'B' },  // React å’Œ TypeScript æœ‰å…³è”
  { source: 'B', target: 'C' },  // TypeScript å’Œ Vite æœ‰å…³è”
  // ...
];

// 2. åˆ›å»ºåŠ›æ¨¡æ‹Ÿ
const simulation = d3.forceSimulation(nodes)
  .force('link', d3.forceLink(links)
    .id(d => d.id)
    .distance(150))              // å¼¹ç°§åŠ›ï¼Œç†æƒ³è·ç¦» 150px
    
  .force('charge', d3.forceManyBody()
    .strength(-500))              // ç”µè·åŠ›ï¼Œæ’æ–¥å¼ºåº¦ -500
    
  .force('center', d3.forceCenter(width / 2, height / 2))  // ä¸­å¿ƒåŠ›
  
  .force('collision', d3.forceCollide()
    .radius(60));                 // ç¢°æ’åŠ›ï¼Œå®‰å…¨åŠå¾„ 60px

// 3. ç›‘å¬æ¯ä¸€å¸§ï¼Œæ›´æ–° UI
simulation.on('tick', () => {
  // æ›´æ–°è¿çº¿ä½ç½®
  linkElements
    .attr('x1', d => d.source.x)
    .attr('y1', d => d.source.y)
    .attr('x2', d => d.target.x)
    .attr('y2', d => d.target.y);
    
  // æ›´æ–°èŠ‚ç‚¹ä½ç½®
  nodeElements
    .attr('cx', d => d.x)
    .attr('cy', d => d.y);
});
```

### é¢è¯•è¦ç‚¹

**é—®é¢˜**ï¼šå¦‚ä½•è‡ªåŠ¨å¸ƒå±€èŠ‚ç‚¹ï¼Ÿ

**æ–¹æ¡ˆ**ï¼šD3.js åŠ›å¯¼å‘å›¾ï¼ˆç‰©ç†æ¨¡æ‹Ÿï¼‰

**åŸç†**ï¼š
- 4ç§åŠ›ï¼šå¼¹ç°§ã€ç”µè·ã€ä¸­å¿ƒã€ç¢°æ’
- æ¯å¸§è®¡ç®—èŠ‚ç‚¹å—åŠ› â†’ æ›´æ–°ä½ç½®
- é‡å¤è¿­ä»£ç›´åˆ°å¹³è¡¡

**ä¼˜ç‚¹**ï¼šè‡ªåŠ¨å¸ƒå±€ï¼Œæ— éœ€æ‰‹åŠ¨è®¡ç®—åæ ‡

---

## 4. Chrome æ‰©å±•çš„ 5 ä¸ªè¿è¡Œç¯å¢ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Chrome æµè§ˆå™¨                         â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Content      â”‚  â”‚   Popup      â”‚  â”‚ Side Panel   â”‚  â”‚
â”‚  â”‚ Script       â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ è¿è¡Œç¯å¢ƒï¼š    â”‚  â”‚ è¿è¡Œç¯å¢ƒï¼š    â”‚  â”‚ è¿è¡Œç¯å¢ƒï¼š    â”‚  â”‚
â”‚  â”‚ ç½‘é¡µä¸­       â”‚  â”‚ ç‹¬ç«‹é¡µé¢     â”‚  â”‚ ç‹¬ç«‹é¡µé¢     â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ èƒ½è®¿é—®ï¼š      â”‚  â”‚ èƒ½è®¿é—®ï¼š      â”‚  â”‚ èƒ½è®¿é—®ï¼š      â”‚  â”‚
â”‚  â”‚ âœ… ç½‘é¡µDOM   â”‚  â”‚ âŒ ç½‘é¡µDOM   â”‚  â”‚ âŒ ç½‘é¡µDOM   â”‚  â”‚
â”‚  â”‚ âœ… Chrome APIâ”‚  â”‚ âœ… Chrome APIâ”‚  â”‚ âœ… Chrome APIâ”‚  â”‚
â”‚  â”‚ âŒ æ‰©å±•é¡µé¢  â”‚  â”‚ âœ… æ‰©å±•é¡µé¢  â”‚  â”‚ âœ… æ‰©å±•é¡µé¢  â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ ç”Ÿå‘½å‘¨æœŸï¼š    â”‚  â”‚ ç”Ÿå‘½å‘¨æœŸï¼š    â”‚  â”‚ ç”Ÿå‘½å‘¨æœŸï¼š    â”‚  â”‚
â”‚  â”‚ é¡µé¢åŠ è½½æ—¶   â”‚  â”‚ ç‚¹å‡»å›¾æ ‡æ—¶   â”‚  â”‚ æ‰“å¼€ä¾§æ æ—¶   â”‚  â”‚
â”‚  â”‚ æ³¨å…¥         â”‚  â”‚ æ‰“å¼€         â”‚  â”‚ åŠ è½½         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                 â†“                 â†“           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                           â”‚                             â”‚
â”‚                           â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚       Background Service Worker                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ è¿è¡Œç¯å¢ƒï¼šç‹¬ç«‹çš„ Worker çº¿ç¨‹                     â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ èƒ½è®¿é—®ï¼š                                         â”‚   â”‚
â”‚  â”‚ âŒ ç½‘é¡µ DOM                                     â”‚   â”‚
â”‚  â”‚ âŒ window å¯¹è±¡                                  â”‚   â”‚
â”‚  â”‚ âœ… Chrome API                                   â”‚   â”‚
â”‚  â”‚ âœ… æ¶ˆæ¯ä¼ é€’                                      â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ ç”Ÿå‘½å‘¨æœŸï¼šäº‹ä»¶é©±åŠ¨ï¼Œä¸æŒä¹…è¿è¡Œ                   â”‚   â”‚
â”‚  â”‚ - æ”¶åˆ°æ¶ˆæ¯æ—¶å”¤é†’                                 â”‚   â”‚
â”‚  â”‚ - ç©ºé—² 30 ç§’åä¼‘çœ                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                             â”‚
â”‚                           â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚       Offscreen Document                        â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ è¿è¡Œç¯å¢ƒï¼šä¸å¯è§çš„é¡µé¢                           â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ èƒ½è®¿é—®ï¼š                                         â”‚   â”‚
â”‚  â”‚ âœ… DOM / window                                 â”‚   â”‚
â”‚  â”‚ âœ… Chrome API                                   â”‚   â”‚
â”‚  â”‚ âœ… window.ai (å…³é”®!)                            â”‚   â”‚
â”‚  â”‚                                                 â”‚   â”‚
â”‚  â”‚ ç”Ÿå‘½å‘¨æœŸï¼šæŒ‰éœ€åˆ›å»ºï¼Œç”¨å®Œå¯é”€æ¯                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€šä¿¡æ–¹å¼

```
Content Script â†’ Background:
chrome.runtime.sendMessage({ type: 'XXX', payload: {...} })

Background â†’ Content Script:
chrome.tabs.sendMessage(tabId, { type: 'XXX', payload: {...} })

Background â†” Popup/SidePanel:
chrome.runtime.sendMessage({ type: 'XXX', payload: {...} })

Background â†” Offscreen:
chrome.runtime.sendMessage({ type: 'XXX', payload: {...} })
```

---

## 5. Zustand çŠ¶æ€ç®¡ç†

### ä¸ºä»€ä¹ˆé€‰ Zustandï¼Ÿ

```
Redux:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½“ç§¯å¤§ï¼ˆ10KB+ï¼‰                     â”‚
â”‚  éœ€è¦ Provider åŒ…è£¹                  â”‚
â”‚  éœ€è¦ actionsã€reducersã€dispatch   â”‚
â”‚  æ ·æ¿ä»£ç å¤š                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Context API:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç®€å•æ˜“ç”¨                            â”‚
â”‚  ä½†æ€§èƒ½å·®ï¼ˆæ‰€æœ‰æ¶ˆè´¹è€…éƒ½é‡æ¸²æŸ“ï¼‰      â”‚
â”‚  å¤š Context åµŒå¥—åœ°ç‹±                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Zustand:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½“ç§¯å°ï¼ˆ1KBï¼‰âœ…                     â”‚
â”‚  æ— éœ€ Provider âœ…                    â”‚
â”‚  API ç®€æ´ âœ…                        â”‚
â”‚  æ€§èƒ½å¥½ï¼ˆé€‰æ‹©æ€§è®¢é˜…ï¼‰âœ…              â”‚
â”‚  TypeScript æ”¯æŒå¥½ âœ…               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½¿ç”¨ç¤ºä¾‹

```typescript
// 1. åˆ›å»º Store
import create from 'zustand';

interface AppState {
  notes: Note[];
  loading: boolean;
  loadNotes: () => Promise<void>;
  deleteNote: (id: string) => Promise<void>;
}

const useStore = create<AppState>((set, get) => ({
  // çŠ¶æ€
  notes: [],
  loading: false,
  
  // å¼‚æ­¥æ“ä½œ
  loadNotes: async () => {
    set({ loading: true });
    
    const response = await chrome.runtime.sendMessage({ 
      type: MessageType.GET_NOTES 
    });
    
    set({ 
      notes: response.notes,
      loading: false
    });
  },
  
  // åŒæ­¥æ“ä½œ
  deleteNote: async (id: string) => {
    // å…ˆä¹è§‚æ›´æ–° UI
    set(state => ({
      notes: state.notes.filter(n => n.id !== id)
    }));
    
    // å†è°ƒç”¨ API
    await chrome.runtime.sendMessage({ 
      type: MessageType.DELETE_NOTE,
      payload: { id }
    });
  }
}));

// 2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
function NoteList() {
  // é€‰æ‹©æ€§è®¢é˜…ï¼šåªè®¢é˜… notesï¼Œä¸è®¢é˜… loading
  const notes = useStore(state => state.notes);
  const deleteNote = useStore(state => state.deleteNote);
  
  return (
    <div>
      {notes.map(note => (
        <NoteCard 
          key={note.id} 
          note={note} 
          onDelete={() => deleteNote(note.id)} 
        />
      ))}
    </div>
  );
}

// 3. é€‰æ‹©æ€§è®¢é˜…çš„å¥½å¤„
function LoadingIndicator() {
  // åªè®¢é˜… loadingï¼Œnotes å˜åŒ–ä¸ä¼šè§¦å‘é‡æ¸²æŸ“
  const loading = useStore(state => state.loading);
  
  return loading ? <Spinner /> : null;
}
```

---

## 6. Vite å¤šå…¥å£æ„å»º

### é—®é¢˜ï¼šChrome æ‰©å±•æœ‰å¤šä¸ªç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒ

```
éœ€è¦åˆ†åˆ«æ‰“åŒ…ï¼š
- popup/index.html â†’ popup/index.js
- sidepanel/index.html â†’ sidepanel/index.js
- background/service-worker.ts â†’ background/service-worker.js
- background/offscreen.ts â†’ background/offscreen.js
- content/content.ts â†’ content/content.js
```

### Vite é…ç½®

```typescript
// vite.config.ts
export default defineConfig({
  build: {
    rollupOptions: {
      input: {
        'popup/index': resolve(__dirname, 'src/popup/index.html'),
        'sidepanel/index': resolve(__dirname, 'src/sidepanel/index.html'),
        background: resolve(__dirname, 'src/background/service-worker.ts'),
        offscreen: resolve(__dirname, 'src/background/offscreen.ts'),
        content: resolve(__dirname, 'src/content/content.ts'),
      },
      output: {
        entryFileNames: (chunkInfo) => {
          if (chunkInfo.name === 'background') 
            return 'background/service-worker.js';
          if (chunkInfo.name === 'offscreen') 
            return 'background/offscreen.js';
          if (chunkInfo.name === 'content') 
            return 'content/content.js';
          if (chunkInfo.name.startsWith('popup')) 
            return 'popup/index.js';
          if (chunkInfo.name.startsWith('sidepanel')) 
            return 'sidepanel/index.js';
          return 'assets/[name]-[hash].js';
        }
      }
    }
  }
});
```

### æ„å»ºç»“æœ

```
dist/
â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ index.js
â”œâ”€â”€ sidepanel/
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ index.js
â”œâ”€â”€ background/
â”‚   â”œâ”€â”€ service-worker.js
â”‚   â”œâ”€â”€ offscreen.html
â”‚   â””â”€â”€ offscreen.js
â”œâ”€â”€ content/
â”‚   â”œâ”€â”€ content.js
â”‚   â””â”€â”€ content.css
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ client-xxx.js (å…±äº«ä»£ç )
â”‚   â”œâ”€â”€ types-xxx.js (å…±äº«ä»£ç )
â”‚   â””â”€â”€ index-xxx.css (å…±äº«æ ·å¼)
â””â”€â”€ manifest.json
```

---

## 7. å…³é”®ä»£ç ç‰‡æ®µé€ŸæŸ¥

### æ–‡æœ¬é€‰æ‹©ç›‘å¬
```typescript
document.addEventListener('mouseup', () => {
  const selection = window.getSelection();
  const text = selection?.toString().trim();
  
  if (text && text.length > 10) {
    showFloatingButton(text);
  }
});
```

### æ¶ˆæ¯ä¼ é€’
```typescript
// å‘é€
chrome.runtime.sendMessage({
  type: MessageType.COLLECT_TEXT,
  payload: { text, url, title }
});

// æ¥æ”¶
chrome.runtime.onMessage.addListener((msg, sender, sendResponse) => {
  if (msg.type === MessageType.COLLECT_TEXT) {
    handleCollectText(msg.payload).then(sendResponse);
    return true; // ä¿æŒé€šé“å¼€å¯
  }
});
```

### Chrome Storage
```typescript
// ä¿å­˜
await chrome.storage.local.set({ 
  webmind_notes: notes 
});

// è¯»å–
const result = await chrome.storage.local.get('webmind_notes');
const notes = result.webmind_notes || [];

// ç›‘å¬å˜åŒ–
chrome.storage.onChanged.addListener((changes, namespace) => {
  if (namespace === 'local' && changes.webmind_notes) {
    const newNotes = changes.webmind_notes.newValue;
    // æ›´æ–° UI
  }
});
```

### AI è°ƒç”¨
```typescript
const summarizer = await window.ai.summarizer.create({
  type: 'tldr',
  format: 'plain-text',
  length: 'medium',
  sharedContext: 'Web content summary',
  monitor(m) {
    m.addEventListener('downloadprogress', (e) => {
      console.log(`ä¸‹è½½è¿›åº¦ï¼š${Math.round(e.loaded * 100)}%`);
    });
  }
});

const summary = await summarizer.summarize(text);
summarizer.destroy(); // é‡Šæ”¾èµ„æº
```

### D3 åŠ›å¯¼å‘å›¾
```typescript
const simulation = d3.forceSimulation(nodes)
  .force('link', d3.forceLink(links).distance(150))
  .force('charge', d3.forceManyBody().strength(-500))
  .force('center', d3.forceCenter(width/2, height/2))
  .force('collision', d3.forceCollide().radius(60));

simulation.on('tick', updatePositions);
```

### D3 æ‹–æ‹½
```typescript
const drag = d3.drag()
  .on('start', (event, d) => {
    if (!event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
  })
  .on('drag', (event, d) => {
    d.fx = event.x;
    d.fy = event.y;
  })
  .on('end', (event, d) => {
    if (!event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
  });

nodeElements.call(drag);
```

### Zustand Store
```typescript
const useStore = create<AppState>((set) => ({
  notes: [],
  
  loadNotes: async () => {
    const response = await chrome.runtime.sendMessage({ 
      type: MessageType.GET_NOTES 
    });
    set({ notes: response.notes });
  },
  
  deleteNote: async (id: string) => {
    set(state => ({ 
      notes: state.notes.filter(n => n.id !== id) 
    }));
    await chrome.runtime.sendMessage({ 
      type: MessageType.DELETE_NOTE, 
      payload: { id } 
    });
  }
}));
```

---

## 8. é¢è¯•å…³é”®æ•°å­—

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ€»ä»£ç è¡Œæ•° | ~2,500 è¡Œ |
| æ ¸å¿ƒæ¨¡å—æ•° | 5 ä¸ª |
| React ç»„ä»¶æ•° | 4 ä¸ª |
| æŠ€æœ¯æ ˆæ•°é‡ | 6 ä¸ªä¸»è¦æŠ€æœ¯ |
| å¼€å‘æ—¶é—´ | çº¦ 3-4 å‘¨ |
| Chrome æƒé™ | 5 ä¸ªï¼ˆæœ€å°åŒ–ï¼‰ |
| D3.js åŠ›çš„ç§ç±» | 4 ç§ |
| Offscreen åˆ›å»ºæ—¶æœº | æŒ‰éœ€åˆ›å»ºï¼Œå¤ç”¨ |
| é»˜è®¤èŠ‚ç‚¹è·ç¦» | 150px |
| ç”µè·åŠ›å¼ºåº¦ | -500 |
| ç¢°æ’åŠå¾„ | 60px |
| Zustand ä½“ç§¯ | ~1KB |
| Redux ä½“ç§¯ | ~10KB |

---

## 9. ä¸€å¥è¯æ€»ç»“

| æŠ€æœ¯ç‚¹ | ä¸€å¥è¯æ€»ç»“ |
|--------|-----------|
| **æ•´ä½“æ¶æ„** | 5ä¸ªæ¨¡å—é€šè¿‡æ¶ˆæ¯ä¼ é€’åä½œï¼Œæ•°æ®å­˜å‚¨åœ¨æœ¬åœ° |
| **Offscreen** | åˆ›å»ºä¸å¯è§é¡µé¢ä»£ç†è°ƒç”¨AIï¼Œè§£å†³Workeræ— DOMé—®é¢˜ |
| **D3åŠ›å¯¼å‘** | 4ç§åŠ›ï¼ˆå¼¹ç°§ã€ç”µè·ã€ä¸­å¿ƒã€ç¢°æ’ï¼‰è‡ªåŠ¨å¸ƒå±€èŠ‚ç‚¹ |
| **Zustand** | è½»é‡çº§çŠ¶æ€ç®¡ç†ï¼Œé€‰æ‹©æ€§è®¢é˜…ï¼Œæ— éœ€Provider |
| **Viteæ„å»º** | å¤šå…¥å£é…ç½®ï¼Œåˆ†åˆ«æ‰“åŒ…5ä¸ªè¿è¡Œç¯å¢ƒ |
| **æ¶ˆæ¯ä¼ é€’** | chrome.runtime.sendMessage + onMessageç›‘å¬ |
| **å­˜å‚¨æ–¹æ¡ˆ** | chrome.storage.localï¼Œæœ¬åœ°åŒ–ï¼Œæ— é™å®¹é‡ |
| **AIè°ƒç”¨** | window.ai.summarizerï¼Œéœ€ç”¨æˆ·æ¿€æ´»ï¼Œæœ‰é™çº§ |
| **æ€§èƒ½ä¼˜åŒ–** | é˜²æŠ–ã€memoã€è™šæ‹Ÿæ»šåŠ¨ã€é™åˆ¶èŠ‚ç‚¹æ•° |
| **éšç§ä¿æŠ¤** | çº¯æœ¬åœ°ï¼Œæ— æœåŠ¡å™¨ï¼Œç¬¦åˆV3è§„èŒƒ |

---

## 10. è®°å¿†å£è¯€

**é¡¹ç›®æµç¨‹**ï¼š
> é€‰æ–‡æœ¬ â†’ æ˜¾æŒ‰é’® â†’ è°ƒAI â†’ å­˜ç¬”è®° â†’ çœ‹å¯¼å›¾

**5ä¸ªæ¨¡å—**ï¼š
> Contentæ³¨å…¥ â†’ Backgroundè·¯ç”± â†’ Offscreenè°ƒAI â†’ Popupç®€å• â†’ SidePanelå®Œæ•´

**4ç§åŠ›**ï¼š
> å¼¹ç°§æ‹‰è¿‘ ç”µè·æ¨è¿œ ä¸­å¿ƒèšæ‹¢ ç¢°æ’åˆ†æ•£

**æŠ€æœ¯æ ˆ**ï¼š
> Reactå†™UI TypeScriptä¿ç±»å‹ Zustandç®¡çŠ¶æ€ D3ç”»å¯¼å›¾ Viteæ¥æ„å»º ChromeAPIé€šä¿¡

---

å¸Œæœ›è¿™äº›å›¾è§£èƒ½å¸®åŠ©ä½ å¿«é€Ÿç†è§£é¡¹ç›®çš„æ ¸å¿ƒæŠ€æœ¯ï¼

è®°ä½ï¼šé¢è¯•æ—¶è¦ç”»å›¾ï¼Œå›¾æ¯”æ–‡å­—æ›´ç›´è§‚ï¼ğŸ¨

