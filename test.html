<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebMind 扩展测试页面</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      line-height: 1.6;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
    }
    .container {
      background: white;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }
    h1 {
      color: #667eea;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }
    .test-section {
      margin: 30px 0;
      padding: 20px;
      background: #f7f9fc;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }
    .test-section h2 {
      color: #764ba2;
      margin-top: 0;
    }
    .selectable-text {
      padding: 15px;
      background: #fff;
      border: 2px dashed #667eea;
      border-radius: 6px;
      margin: 15px 0;
      user-select: text;
      cursor: text;
    }
    .instructions {
      background: #e7f3ff;
      padding: 15px;
      border-radius: 6px;
      margin: 20px 0;
    }
    .instructions ol {
      margin: 10px 0;
      padding-left: 25px;
    }
    .instructions li {
      margin: 8px 0;
    }
    .alert {
      background: #fff3cd;
      border: 1px solid #ffc107;
      padding: 15px;
      border-radius: 6px;
      margin: 20px 0;
    }
    .success {
      background: #d4edda;
      border: 1px solid #28a745;
    }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 0.9em;
    }
    .emoji {
      font-size: 1.5em;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1><span class="emoji">🧠</span>WebMind 扩展测试页面</h1>
    <p class="subtitle">用这个页面来测试你的 WebMind Chrome 扩展是否正常工作</p>

    <div class="test-section">
      <h2>📋 测试步骤</h2>
      <div class="instructions">
        <ol>
          <li>确保你已经在 <code>chrome://extensions/</code> 页面<strong>重新加载</strong>了扩展</li>
          <li><strong>刷新这个页面</strong>（F5 或 Cmd+R）</li>
          <li>按 <code>F12</code> 打开<strong>开发者控制台</strong></li>
          <li>查看控制台是否有 "🔵 WebMind Content Script 开始初始化" 的消息</li>
          <li>在下面的文本框中<strong>选中一段文字</strong>（超过10个字符）</li>
          <li>观察是否出现<strong>"添加到笔记"</strong>按钮</li>
          <li>点击按钮，查看控制台的日志输出</li>
        </ol>
      </div>
    </div>

    <div class="test-section">
      <h2>✍️ 测试文本 1 - 中文</h2>
      <div class="selectable-text">
        人工智能（Artificial Intelligence），英文缩写为AI。它是研究、开发用于模拟、延伸和扩展人的智能的理论、方法、技术及应用系统的一门新的技术科学。人工智能是计算机科学的一个分支，它企图了解智能的实质，并生产出一种新的能以人类智能相似的方式做出反应的智能机器，该领域的研究包括机器人、语言识别、图像识别、自然语言处理和专家系统等。
      </div>
    </div>

    <div class="test-section">
      <h2>🌏 测试文本 2 - 英文</h2>
      <div class="selectable-text">
        Chrome Built-in AI is a revolutionary feature that brings artificial intelligence capabilities directly into the browser. This innovative technology allows developers to create AI-powered web applications without relying on external APIs or cloud services. The Summarizer API, in particular, enables automatic text summarization using machine learning models that run locally in the browser, ensuring both privacy and performance.
      </div>
    </div>

    <div class="test-section">
      <h2>📊 测试文本 3 - 技术内容</h2>
      <div class="selectable-text">
        Chrome 扩展程序主要由以下几个部分组成：Manifest 配置文件、Background Service Worker（后台脚本）、Content Scripts（内容脚本）、Popup 页面和 Side Panel（侧边栏）。Content Scripts 运行在网页的上下文中，可以访问和操作 DOM，而 Background Service Worker 则处理后台任务和消息传递。这种架构设计使得扩展程序既能与网页交互，又能保持独立的运行环境。
      </div>
    </div>

    <div class="alert">
      <h3>⚠️ 常见问题排查</h3>
      <p><strong>如果控制台没有任何输出：</strong></p>
      <ul>
        <li>检查扩展是否已启用（chrome://extensions/）</li>
        <li>确保点击了扩展的"重新加载"按钮</li>
        <li>刷新这个测试页面</li>
        <li>检查是否有错误消息（红色文字）</li>
      </ul>
      
      <p><strong>如果看到 Content Script 加载日志但按钮不出现：</strong></p>
      <ul>
        <li>确保选中的文字超过 10 个字符</li>
        <li>查看控制台的文本长度日志</li>
        <li>检查是否有 CSS 冲突</li>
      </ul>
      
      <p><strong>如果按钮出现但点击没反应：</strong></p>
      <ul>
        <li>查看控制台是否有 "🎉 点击了浮动按钮" 的日志</li>
        <li>查看是否有网络或权限错误</li>
        <li>检查 Background Service Worker 的控制台（在扩展管理页面点击 "service worker"）</li>
      </ul>
    </div>

    <div class="alert success">
      <h3>✅ 如果一切正常，你应该看到：</h3>
      <ul>
        <li>控制台显示：<code>🔵 WebMind Content Script 开始初始化</code></li>
        <li>控制台显示：<code>🔵 WebMind Content Script 已加载完成</code></li>
        <li>选中文字后，控制台显示：<code>📋 检测到文本选择事件</code></li>
        <li>出现渐变色的"添加到笔记"浮动按钮</li>
        <li>点击后，控制台显示：<code>🎉 点击了浮动按钮！</code></li>
        <li>页面右上角显示绿色的成功提示：<code>已添加到笔记！</code></li>
      </ul>
    </div>

    <div class="test-section">
      <h2>🔧 调试技巧</h2>
      <p><strong>查看 Background Service Worker 日志：</strong></p>
      <ol>
        <li>打开 <code>chrome://extensions/</code></li>
        <li>找到 WebMind 扩展</li>
        <li>点击 "service worker" 链接（在扩展详情下方）</li>
        <li>查看 Background 的控制台输出</li>
      </ol>
      
      <p><strong>检查存储的笔记：</strong></p>
      <ol>
        <li>在任何页面按 F12 打开开发者工具</li>
        <li>切换到 Application 标签</li>
        <li>展开左侧的 Storage → Local Storage</li>
        <li>找到扩展的存储，查看 <code>webmind_notes</code> 键</li>
      </ol>
    </div>
  </div>

  <script>
    console.log('%c🧪 WebMind 测试页面已加载', 'color: #667eea; font-size: 16px; font-weight: bold;');
    console.log('%c请选中上面的任意文本进行测试', 'color: #764ba2; font-size: 14px;');
    
    // 监听选择事件，显示调试信息
    document.addEventListener('mouseup', () => {
      const selection = window.getSelection();
      const text = selection?.toString().trim();
      if (text) {
        console.log(`%c📝 你选中了 ${text.length} 个字符`, 'color: #28a745; font-size: 12px;');
        console.log('选中的文本:', text.substring(0, 50) + (text.length > 50 ? '...' : ''));
      }
    });
  </script>
</body>
</html>

